{% extends 'layout.html' %}
{% block content %}
  <div class="container">

    {% if messages %}
    {% for message in messages %}
        <div class="alert 
            {% if message.tags == 'success' %}alert-success{% elif message.tags == 'warning' %}alert-danger{% elif message.tags == 'info' %}alert-info{% endif %}
            alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    {% endfor %}
{% endif %}

          
<div class="d-flex justify-content-between align-items-center mb-4">
  <a href="{% url 'producers' %}">
    <h1 style="color: #7d1324" class="mb-0">Producers</h1>
  </a>
  
    <div class="d-flex align-items-center">
      <h1 style="color: #7d1324" >
        {% if user.is_authenticated and perms.app.add_producer %}
          <a href="{% url 'producer_add' %}" ><i class="bi bi-plus-square-fill mt-1 mr-2" style="color: #7d1324" ></i>  
          </a>  
        {% endif %}
      </h1>
  
      <form action="." method="post" class="d-flex mb-0">
        {% csrf_token %}
        <div class="input-group">
          {{ form.query }}
          <button type="submit" class="btn btn-primary">Search</button>
        </div>
      </form>
    </div>
  </div>

    <div class="row">
      {% for producer in producers %}
        <div class="col-md-6 mb-3">
          <div class="card mb-3" style="max-width: 540px;">
            <div class="row no-gutters align-items-center">
              <div class="col-md-4 d-flex justify-content-center align-items-center">
                <a href="{% url 'producer_details' producer.id %}" title="Click to see producer details" style="text-decoration: none; color: #7d1324;">
                {% if producer.picture %}
                
                  <img src="{{ producer.picture.url }}" class="card-img" alt="{{ producer.name }}" style="object-fit: cover; width: 150px; height: 150px; border-radius: 50%;" />
                {% else %}
                  <img src="https://static-00.iconduck.com/assets.00/profile-default-icon-512x511-v4sw4m29.png" class="card-img" alt="{{ producer.name }}" style="object-fit: cover; width: 150px; height: 150px; border-radius: 50%;" />
                {% endif %}
                </a>
              </div>
              <div class="col-md-8">
                <div class="card-body">
                  <a href="{% url 'producer_details' producer.id %}" title="Click to see producer details" style="text-decoration: none; color: #7d1324;">
                    
                        <h5 class="card-title producer-name-on-card">{{ producer.name }}
                        </h5>
                   
                    
                  </a>
                  <p class="card-text" style="color: #343a40; font-size: 1.1em; font-weight: 500;"><strong>Date of Birth:</strong> {{ producer.date_of_birth }}</p>
                  {% if producer.date_of_death %}
                  <p class="card-text" style="color: #343a40; font-size: 1.1em; font-weight: 500;"><strong>Date of Death</strong> {{ producer.date_of_death }}</p>
                  {% endif %}
                  {% if producer.biography %}
                    <p class="card-text">{{ producer.biography |truncatewords:5}}</p>
                  {% else %}
                    <p class="card-text">No biography available</p>
                  {% endif %}
           
                  <!-- -<p class="card-text">{{producer.biography}}</p> -->
                  <p class="card-text">
                    <small class="text-muted">Number of Movies: {{producer.movies.count}}</small>
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
{% endblock %}